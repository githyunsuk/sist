<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>

<!-- favicon 설정 -->
<link rel="shorcut icon" href="http://192.168.10.75/images/favicon.ico"/>
<!-- 부트스트랩 CDN -->
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css"/>

<style type="text/css">

</style>
<!-- jquery CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script> 
<script type="text/javascript">
$(function(){
 	$("#btnAdd").click(function(){ addMember() });
 	$("#btnSearchAll").click(function(){ searchAllMember() });
});

function addMember(){
	var id = $("#id").val();
	var name = $("#name").val();
	var age = $("#age").val();
	
	var jsonParam = {id:id, name:name, age:age}
	var jsonParamStr = JSON.stringify(jsonParam);
	
	$.ajax({
		url: "/member",
		type: "POST",
		contentType: "application/JSON",
		data: jsonParamStr,
		success: function(jsonObj){
			//message=추가실패 - 아이디가 존재합니다. | 추가성공
			alert(jsonObj.message)
		}
	});
}

function searchAllMember(){
	$.ajax({
		url:"/members",
		type:"GET",
		contentType:"application/json",
		dataType:"JSON",
		error:function(xhr){
			alert(xhr.status);
		},
		success:function(jsonArr){
			var output=`<ul><li>전체 사원수 ${jsonArr.length}명</li>`;
			if(jsonArr.length == 0){
				output += "<li>회원정보가 존재하지 않습니다.</li>"
			}
			$.each(jsonArr, function(ind, jsonObj){
				output += `<li>아이디 : ${jsonObj.id}, 이름 : ${jsonObj.name}, 나이 : ${jsonObj.age}</li>`;
			});
			output += "</ul>";
			
			$("#output").html(output);
		}
	});
}
</script>
</head>
<body>
<div>
<h2>회원추가</h2>
<label>아이디</label><input type="text" name="id" id="id"/><br>
<label>이름</label><input type="text" name="name" id="name"/><br>
<label>나이</label><input type="text" name="age" id="age"/><br>
<input type="button" value="회원추가" class="btn btn-success" id="btnAdd"/>
</div>
<input type="button" value="전체회원 조회" class="btn btn-success" id="btnSearchAll">
<div id="output"></div>
</body>
</html>